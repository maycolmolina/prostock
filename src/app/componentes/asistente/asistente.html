<div class="top-header">
  <div style="display: flex; align-items: center; gap: 15px;">
    <h1 style="font-size: 24px; font-weight: 700;">Asistente Virtual Inteligente</h1>
    <span style="background: #10b981; color: white; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600;">
      IA ACTIVA
    </span>
  </div>
  
  <div class="user-actions">
    <div class="user-profile">
      <div class="avatar">UD</div>
      <div>
        <div style="font-weight: 600;">usuario </div>
        <div style="font-size: 12px; color: #64748b;">prostock</div>
      </div>
    </div>
  </div>
</div>

<main>
  <div class="cajachat">
    <div class="ava">
      <i class="fas fa-robot hh"></i>
      <div class="tt">
        <p class="leftex u">Asistente ProStock</p>
        <p class="leftex">especialista en optimizacion de produccion</p>
      </div>
    </div>
    <div #chatcont class="chat-container">
      @for (mensaje of mensajes; track $index) {
      <div class="message-box" [ngClass]="{ endsms: mensaje.user === 'user' }">
        @if (mensaje.user === 'bot') {
        <div class="bot">
          <svg
            viewBox="0 0 24 24"
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            fill="#000000"
          >
            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
            <g id="SVGRepo_iconCarrier">
              <!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
              <title>ic_fluent_bot_24_regular</title>
              <desc>Created with Sketch.</desc>
              <g
                id="🔍-Product-Icons"
                stroke="none"
                stroke-width="1"
                fill="none"
                fill-rule="evenodd"
              >
                <g id="ic_fluent_bot_24_regular" fill="#ffffff" fill-rule="nonzero">
                  <path
                    d="M17.7530511,13.999921 C18.9956918,13.999921 20.0030511,15.0072804 20.0030511,16.249921 L20.0030511,17.1550008 C20.0030511,18.2486786 19.5255957,19.2878579 18.6957793,20.0002733 C17.1303315,21.344244 14.8899962,22.0010712 12,22.0010712 C9.11050247,22.0010712 6.87168436,21.3444691 5.30881727,20.0007885 C4.48019625,19.2883988 4.00354153,18.2500002 4.00354153,17.1572408 L4.00354153,16.249921 C4.00354153,15.0072804 5.01090084,13.999921 6.25354153,13.999921 L17.7530511,13.999921 Z M17.7530511,15.499921 L6.25354153,15.499921 C5.83932796,15.499921 5.50354153,15.8357075 5.50354153,16.249921 L5.50354153,17.1572408 C5.50354153,17.8128951 5.78953221,18.4359296 6.28670709,18.8633654 C7.5447918,19.9450082 9.44080155,20.5010712 12,20.5010712 C14.5599799,20.5010712 16.4578003,19.9446634 17.7186879,18.8621641 C18.2165778,18.4347149 18.5030511,17.8112072 18.5030511,17.1550005 L18.5030511,16.249921 C18.5030511,15.8357075 18.1672647,15.499921 17.7530511,15.499921 Z M11.8985607,2.00734093 L12.0003312,2.00049432 C12.380027,2.00049432 12.6938222,2.2826482 12.7434846,2.64872376 L12.7503312,2.75049432 L12.7495415,3.49949432 L16.25,3.5 C17.4926407,3.5 18.5,4.50735931 18.5,5.75 L18.5,10.254591 C18.5,11.4972317 17.4926407,12.504591 16.25,12.504591 L7.75,12.504591 C6.50735931,12.504591 5.5,11.4972317 5.5,10.254591 L5.5,5.75 C5.5,4.50735931 6.50735931,3.5 7.75,3.5 L11.2495415,3.49949432 L11.2503312,2.75049432 C11.2503312,2.37079855 11.5324851,2.05700336 11.8985607,2.00734093 L12.0003312,2.00049432 L11.8985607,2.00734093 Z M16.25,5 L7.75,5 C7.33578644,5 7,5.33578644 7,5.75 L7,10.254591 C7,10.6688046 7.33578644,11.004591 7.75,11.004591 L16.25,11.004591 C16.6642136,11.004591 17,10.6688046 17,10.254591 L17,5.75 C17,5.33578644 16.6642136,5 16.25,5 Z M9.74928905,6.5 C10.4392523,6.5 10.9985781,7.05932576 10.9985781,7.74928905 C10.9985781,8.43925235 10.4392523,8.99857811 9.74928905,8.99857811 C9.05932576,8.99857811 8.5,8.43925235 8.5,7.74928905 C8.5,7.05932576 9.05932576,6.5 9.74928905,6.5 Z M14.2420255,6.5 C14.9319888,6.5 15.4913145,7.05932576 15.4913145,7.74928905 C15.4913145,8.43925235 14.9319888,8.99857811 14.2420255,8.99857811 C13.5520622,8.99857811 12.9927364,8.43925235 12.9927364,7.74928905 C12.9927364,7.05932576 13.5520622,6.5 14.2420255,6.5 Z"
                    id="🎨-Color"
                  ></path>
                </g>
              </g>
            </g>
          </svg>
        </div>
        }
        <markdown [data]="mensaje.sms"></markdown>
      </div>
      }
    </div>
    <div class="input-container">
      <input
        class="form-control"
        [(ngModel)]="userPrompt"
        placeholder="Escribe tu pregunta aquí..."
        (keyup.enter)="sendMessage()"
      />
      <button class="btn btn-dark" (click)="sendMessage()" [disabled]="isLoading">
        {{ isLoading ? 'Enviando...' : 'Enviar' }}
      </button>
    </div>
    <div class="quick-actions">
      <button class="action-btn" data-message="Analiza mis costos de producción">
        <i class="fas fa-calculator"></i> Análisis de Costos
      </button>
      <button class="action-btn" data-message="Sugiere alternativas para reducir desperdicios">
        <i class="fas fa-recycle"></i> Reducir Desperdicios
      </button>
      <button class="action-btn" data-message="Optimiza mis patrones de corte">
        <i class="fas fa-cut"></i> Optimizar Patrones
      </button>
      <button class="action-btn" data-message="Revisa mis niveles de inventario">
        <i class="fas fa-boxes"></i> Revisar Inventario
      </button>
    </div>
  </div>

  <div class="suggestions-panel">
    <div class="panel-header">
      <h3 class="panel-title">Sugerencias Inteligentes</h3>
      <p class="panel-subtitle">Basado en tu actividad reciente</p>
    </div>

    <div class="suggestion-cards">
      <div
        (click)="Sugestion('deseo saber sobre la optimizacion de procesos')"
        class="suggestion-card optimization"
      >
        <div class="suggestion-icon">
          <i class="fas fa-bolt"></i>
        </div>
        <div class="suggestion-title">Optimización de Proceso</div>
        <div class="suggestion-desc">
          Puedes reducir tiempo de producción en 15% reorganizando etapas
        </div>
      </div>

      <div class="suggestion-card waste"
      (click)="Sugestion('deseo saber sobre la reduccion de desperdicios')"
      >
        <div class="suggestion-icon">
          <i class="fas fa-trash-restore"></i>
        </div>
        <div class="suggestion-title">Reducción de Desperdicio</div>
        <div class="suggestion-desc">
          Tu desperdicio de tela es 3% mayor que el promedio de tu sector
        </div>
      </div>

      <div class="suggestion-card cost"
      (click)="Sugestion('deseo saber como ahorrar costos')"
      >
        <div class="suggestion-icon">
          <i class="fas fa-dollar-sign"></i>
        </div>
        <div class="suggestion-title">Ahorro de Costos</div>
        <div class="suggestion-desc">Cambiando a proveedor B podrías ahorrar $120/mes en hilos</div>
      </div>

    </div>
  </div>
</main>
